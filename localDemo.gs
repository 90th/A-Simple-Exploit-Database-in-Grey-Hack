import_code("/root/cloudExploitLib")
targetLib = user_input("Lib path to exploit: ")
mx = include_lib("/lib/metaxploit.so")
if not mx then exit("unable to include metaxploit.so")
ml = mx.load(targetLib)
if not ml then exit("unable to load lib")
exploits = queryExploit(ml.lib_name, ml.version) //exploits here looks like {"lib_name":"kernel_module.so", "version":"1.0.0", "memorys"{"0x1DBC026":["andb", "wardowmatch_lengthsbu"], "0xABF3164":["modalposlin", "sedcolor_b"]}}
if not exploits then exploits = localScan(targetLib) //exploits.memorys here looks like {"0x1DBC026":["andb", "wardowmatch_lengthsbu"], "0xABF3164":["modalposlin", "sedcolor_b"]}
for e in exploits.memorys //e here looks like {"key":"0x1DBC026", "value":["andb", "wardowmatch_lengthsbu"]}
    for value in e.value //e.value here looks like ["andb", "wardowmatch_lengthsbu"]
        object = ml.overflow(e.key, value, injectArg) //and the value here looks like "andb"
        if typeof(object) == "shell" then object.start_terminal
        if typeof(object) == "computer" then print(object.File("/etc/passwd").get_content)
    end for
end for
exit("Done. nothing found.")